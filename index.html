<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Gaussian Splatting - Alpha Blending åŸç†æ¼”ç¤º</title>
    <meta name="description" content="äº¤äº’å¼æ¼”ç¤º3D Gaussian Splattingä¸­Front-to-Back Alpha Blendingçš„å·¥ä½œåŸç†">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            min-height: 100vh;
            background: linear-gradient(180deg, #ffffff 0%, #f5f7fa 100%);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            color: #1a1a2e;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* æ ‡é¢˜åŒº */
        .header {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #4285f4 0%, #34a853 50%, #ea4335 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 6px;
        }
        
        .header h2 {
            font-size: 1.1rem;
            font-weight: 500;
            color: #5f6368;
        }
        
        /* ä¸»å†…å®¹åŒº */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 20px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: #ffffff;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            border: 1px solid #e8eaed;
        }
        
        .card-title {
            font-size: 0.8rem;
            color: #4285f4;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 600;
        }
        
        .card-title.green { color: #34a853; }
        
        /* åœºæ™¯å¯è§†åŒ–åŒº */
        .scene-container {
            position: relative;
            height: 180px;
            background: linear-gradient(180deg, #f8f9fa 0%, #e8eaed 100%);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #dadce0;
        }
        
        .camera {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            text-align: center;
        }
        
        .camera-icon { font-size: 1.6rem; }
        .camera-label { font-size: 0.6rem; color: #5f6368; font-weight: 500; }
        
        /* å…‰çº¿åŠ¨ç”» */
        .ray {
            position: absolute;
            left: 50px;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, rgba(66,133,244,0.8), rgba(66,133,244,0));
            animation: rayMove 0.8s linear infinite;
        }
        
        @keyframes rayMove {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* å¤„ç†é¡ºåºæŒ‡ç¤º */
        .order-indicator {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4285f4, #34a853);
            color: #fff;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.65rem;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .order-indicator.visible { opacity: 1; }
        
        /* é«˜æ–¯çƒä½“ */
        .gaussian {
            position: absolute;
            top: 50%;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            transform: translateY(-50%);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0.35;
        }
        
        .gaussian.active { opacity: 1; }
        .gaussian.current {
            opacity: 1;
            transform: translateY(-50%) scale(1.15);
            box-shadow: 0 0 0 3px #fff, 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .gaussian-1 {
            left: 110px;
            background: radial-gradient(circle at 30% 30%, #7aa8f7, #4285f4 55%, #2b5797);
            z-index: 3;
        }
        
        .gaussian-2 {
            left: 190px;
            background: radial-gradient(circle at 30% 30%, #81c784, #4caf50 55%, #2e7d32);
            z-index: 2;
        }
        
        .gaussian-3 {
            left: 270px;
            background: radial-gradient(circle at 30% 30%, #ef9a9a, #e64c4c 55%, #b71c1c);
            z-index: 1;
        }
        
        .gaussian-label {
            position: absolute;
            bottom: -28px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            white-space: nowrap;
        }
        
        .gaussian-label .name {
            font-size: 0.8rem;
            font-weight: 700;
        }
        
        .gaussian-1 .name { color: #4285f4; }
        .gaussian-2 .name { color: #4caf50; }
        .gaussian-3 .name { color: #e64c4c; }
        
        .gaussian-label .info {
            font-size: 0.55rem;
            color: #5f6368;
        }
        
        .gaussian-number {
            position: absolute;
            top: -6px;
            right: -6px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #dadce0;
            color: #9aa0a6;
            font-size: 0.65rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .gaussian.active .gaussian-number {
            background: #4285f4;
            color: #fff;
        }
        
        /* æ·±åº¦è½´ */
        .depth-axis {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.65rem;
            color: #80868b;
            font-weight: 500;
        }
        
        .depth-line {
            width: 140px;
            height: 2px;
            background: linear-gradient(90deg, #4285f4, #ea4335);
            border-radius: 1px;
        }
        
        /* æ··åˆç»“æœåŒº */
        .result-section {
            margin-top: 16px;
            padding: 14px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e8eaed;
        }
        
        .result-row {
            display: flex;
            align-items: flex-start;
            gap: 14px;
        }
        
        .color-preview {
            width: 70px;
            height: 70px;
            border-radius: 10px;
            background: #000;
            transition: all 0.4s;
            border: 2px solid #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .color-label {
            font-size: 0.7rem;
            color: #5f6368;
            margin-bottom: 4px;
            font-weight: 500;
        }
        
        .status-indicators {
            display: flex;
            gap: 5px;
            margin-bottom: 8px;
        }
        
        .status-item {
            flex: 1;
            padding: 5px;
            background: #e8eaed;
            border-radius: 5px;
            text-align: center;
            font-size: 0.65rem;
            font-weight: 600;
            color: #9aa0a6;
            transition: all 0.3s;
        }
        
        .status-item.active {
            color: #fff;
        }
        
        .status-item.g1.active { background: #4285f4; }
        .status-item.g2.active { background: #4caf50; }
        .status-item.g3.active { background: #e64c4c; }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
        }
        
        .info-box {
            padding: 6px 8px;
            background: #fff;
            border-radius: 5px;
            font-size: 0.7rem;
            font-family: "SF Mono", Monaco, monospace;
        }
        
        .info-box .label {
            color: #5f6368;
            margin-bottom: 2px;
        }
        
        .rgb-r { color: #ea4335; }
        .rgb-g { color: #34a853; }
        .rgb-b { color: #4285f4; }
        
        /* å…¬å¼åŒº */
        .formula-box {
            margin-top: 14px;
            padding: 14px;
            background: linear-gradient(135deg, rgba(66,133,244,0.08), rgba(52,168,83,0.08));
            border-radius: 10px;
            border: 2px solid rgba(66,133,244,0.2);
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .formula-box.visible { opacity: 1; }
        
        .formula-main {
            font-size: 1.05rem;
            font-family: "Times New Roman", Georgia, serif;
            color: #202124;
        }
        
        .formula-sub {
            font-size: 0.85rem;
            font-family: "Times New Roman", Georgia, serif;
            color: #5f6368;
            margin-top: 4px;
        }
        
        .formula-expand {
            font-size: 0.8rem;
            font-family: "Times New Roman", Georgia, serif;
            color: #4285f4;
            margin-top: 6px;
            padding-top: 6px;
            border-top: 1px dashed #dadce0;
        }
        
        /* è¯¦ç»†è¯´æ˜åŒº */
        .explanation-content {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 16px;
            border: 1px solid #e8eaed;
            min-height: 380px;
            max-height: 420px;
            overflow-y: auto;
        }
        
        .explanation-title {
            font-size: 1.1rem;
            color: #202124;
            margin-bottom: 12px;
            font-weight: 700;
            border-bottom: 3px solid #4285f4;
            padding-bottom: 8px;
        }
        
        .explanation-text {
            font-size: 0.85rem;
            color: #3c4043;
        }
        
        .explanation-text p {
            margin: 5px 0;
        }
        
        .explanation-text .formula-line {
            font-family: "SF Mono", Monaco, monospace;
            background: #e8f0fe;
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #4285f4;
        }
        
        .explanation-text .highlight {
            background: #e6f4ea;
            padding: 5px 8px;
            border-radius: 4px;
            border-left: 3px solid #34a853;
            color: #137333;
        }
        
        .explanation-text .indent {
            padding-left: 12px;
            color: #5f6368;
        }
        
        /* æ­¥éª¤æŒ‡ç¤ºå™¨ */
        .step-indicators {
            margin-top: 14px;
            display: flex;
            justify-content: center;
            gap: 5px;
        }
        
        .step-dot {
            width: 8px;
            height: 8px;
            border-radius: 4px;
            background: #dadce0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .step-dot.active {
            width: 24px;
            background: linear-gradient(135deg, #4285f4, #34a853);
        }
        
        .step-dot.passed {
            background: rgba(66,133,244,0.4);
        }
        
        /* æ§åˆ¶æŒ‰é’®åŒº */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            font-size: 0.85rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            border: none;
        }
        
        .btn-outline {
            background: #fff;
            border: 2px solid #e8eaed;
            color: #3c4043;
        }
        
        .btn-outline:hover {
            border-color: #4285f4;
            color: #4285f4;
        }
        
        .btn-outline:disabled {
            color: #9aa0a6;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4285f4, #1a73e8);
            color: #fff;
            box-shadow: 0 4px 14px rgba(66,133,244,0.4);
        }
        
        .btn-primary.playing {
            background: linear-gradient(135deg, #ea4335, #d93025);
            box-shadow: 0 4px 14px rgba(234,67,53,0.4);
        }
        
        /* è¿›åº¦ä¿¡æ¯ */
        .progress-info {
            text-align: center;
            margin-top: 14px;
            color: #5f6368;
            font-size: 0.8rem;
        }
        
        /* é¡µè„š */
        .footer {
            text-align: center;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid #e8eaed;
            color: #9aa0a6;
            font-size: 0.75rem;
        }
        
        .footer a {
            color: #4285f4;
            text-decoration: none;
        }
        
        /* åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ ‡é¢˜ -->
        <div class="header">
            <h1>3D Gaussian Splatting</h1>
            <h2>Alpha Blending åŸç†è¯¦è§£ (Front-to-Back)</h2>
        </div>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content">
            <!-- å·¦ä¾§ï¼šå¯è§†åŒ– -->
            <div class="card">
                <div class="card-title">ğŸ¬ æ¸²æŸ“è¿‡ç¨‹å¯è§†åŒ–</div>
                
                <!-- åœºæ™¯ -->
                <div class="scene-container">
                    <!-- ç›¸æœº -->
                    <div class="camera">
                        <div class="camera-icon">ğŸ“·</div>
                        <div class="camera-label">Camera</div>
                    </div>
                    
                    <!-- å…‰çº¿ -->
                    <div class="ray"></div>
                    
                    <!-- å¤„ç†é¡ºåº -->
                    <div class="order-indicator" id="orderIndicator">
                        å¤„ç†é¡ºåº: Gâ‚ â†’ Gâ‚‚ â†’ Gâ‚ƒ (è¿‘â†’è¿œ)
                    </div>
                    
                    <!-- é«˜æ–¯çƒä½“ -->
                    <div class="gaussian gaussian-1" id="g1">
                        <div class="gaussian-number">1</div>
                        <div class="gaussian-label">
                            <div class="name">Gâ‚</div>
                            <div class="info">æœ€è¿‘ | Î±=0.6</div>
                        </div>
                    </div>
                    
                    <div class="gaussian gaussian-2" id="g2">
                        <div class="gaussian-number">2</div>
                        <div class="gaussian-label">
                            <div class="name">Gâ‚‚</div>
                            <div class="info">ä¸­é—´ | Î±=0.5</div>
                        </div>
                    </div>
                    
                    <div class="gaussian gaussian-3" id="g3">
                        <div class="gaussian-number">3</div>
                        <div class="gaussian-label">
                            <div class="name">Gâ‚ƒ</div>
                            <div class="info">æœ€è¿œ | Î±=0.7</div>
                        </div>
                    </div>
                    
                    <!-- æ·±åº¦è½´ -->
                    <div class="depth-axis">
                        <span>Near</span>
                        <div class="depth-line"></div>
                        <span>Far</span>
                    </div>
                </div>
                
                <!-- æ··åˆç»“æœ -->
                <div class="result-section">
                    <div class="result-row">
                        <div>
                            <div class="color-label">ç´¯ç§¯é¢œè‰² C</div>
                            <div class="color-preview" id="colorPreview"></div>
                        </div>
                        <div style="flex: 1;">
                            <div class="color-label">å¤„ç†çŠ¶æ€</div>
                            <div class="status-indicators">
                                <div class="status-item g1" id="status1">Gâ‚</div>
                                <div class="status-item g2" id="status2">Gâ‚‚</div>
                                <div class="status-item g3" id="status3">Gâ‚ƒ</div>
                            </div>
                            <div class="info-grid" id="infoGrid" style="display: none;">
                                <div class="info-box">
                                    <div class="label">ç´¯ç§¯é¢œè‰² C</div>
                                    <div>
                                        <span class="rgb-r" id="rgbR">0</span>,
                                        <span class="rgb-g" id="rgbG">0</span>,
                                        <span class="rgb-b" id="rgbB">0</span>
                                    </div>
                                </div>
                                <div class="info-box">
                                    <div class="label">å„ Táµ¢ å€¼</div>
                                    <div style="color: #4285f4; font-weight: 600; font-size: 0.65rem;">
                                        <span id="transmittance">Tâ‚=1</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å…¬å¼ -->
                <div class="formula-box" id="formulaBox">
                    <div class="formula-main">C = Î£áµ¢ Î±áµ¢ Â· cáµ¢ Â· Táµ¢</div>
                    <div class="formula-sub">å…¶ä¸­ Táµ¢ = âˆ<sub>j&lt;i</sub>(1 - Î±â±¼)ï¼Œ<strong>Tâ‚ = 1</strong>ï¼ˆç©ºç§¯ï¼‰</div>
                    <div class="formula-expand">= Î±â‚câ‚ + (1-Î±â‚)Î±â‚‚câ‚‚ + (1-Î±â‚)(1-Î±â‚‚)Î±â‚ƒcâ‚ƒ + ...</div>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šè¯¦ç»†è¯´æ˜ -->
            <div class="card">
                <div class="card-title green">ğŸ“– è¯¦ç»†è¯´æ˜</div>
                
                <div class="explanation-content">
                    <div class="explanation-title" id="expTitle">ğŸ¯ ä»€ä¹ˆæ˜¯ 3D Gaussian Splatting?</div>
                    <div class="explanation-text" id="expText"></div>
                </div>
                
                <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
                <div class="step-indicators" id="stepIndicators"></div>
            </div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="controls">
            <button class="btn btn-outline" id="prevBtn" onclick="prevStep()">â—€ ä¸Šä¸€æ­¥</button>
            <button class="btn btn-primary" id="playBtn" onclick="togglePlay()">â–¶ è‡ªåŠ¨æ’­æ”¾</button>
            <button class="btn btn-outline" id="nextBtn" onclick="nextStep()">ä¸‹ä¸€æ­¥ â–¶</button>
            <button class="btn btn-outline" onclick="resetDemo()">â†º é‡ç½®</button>
        </div>
        
        <!-- è¿›åº¦ä¿¡æ¯ -->
        <div class="progress-info">
            æ­¥éª¤ <span id="currentStep">1</span> / <span id="totalSteps">7</span>
        </div>
        
        <!-- é¡µè„š -->
        <div class="footer">
            3D Gaussian Splatting Alpha Blending äº¤äº’æ¼”ç¤º | 
            <a href="https://github.com" target="_blank">GitHub</a>
        </div>
    </div>

    <script>
        // é«˜æ–¯æ•°æ®
        const gaussians = [
            { color: [66, 133, 244], alpha: 0.6 },   // G1 è“è‰²
            { color: [76, 175, 80], alpha: 0.5 },    // G2 ç»¿è‰²
            { color: [230, 76, 76], alpha: 0.7 }     // G3 çº¢è‰²
        ];
        
        // å­—å¹•å†…å®¹
        const subtitles = [
            {
                title: "ğŸ¯ ä»€ä¹ˆæ˜¯ 3D Gaussian Splatting?",
                content: `
                    <p>3D Gaussian Splatting (3DGS) æ˜¯ä¸€ç§é©å‘½æ€§çš„3Dåœºæ™¯è¡¨ç¤ºå’Œå®æ—¶æ¸²æŸ“æ–¹æ³•ã€‚</p>
                    <p></p>
                    <p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>ç”¨æ•°ç™¾ä¸‡ä¸ª3Dé«˜æ–¯åˆ†å¸ƒæ¥è¡¨ç¤ºåœºæ™¯ï¼Œæ¯ä¸ªé«˜æ–¯å…·æœ‰ï¼š</p>
                    <p class="indent">â€¢ <strong>ä½ç½® Î¼ âˆˆ â„Â³</strong> â€” é«˜æ–¯ä¸­å¿ƒåœ¨3Dç©ºé—´çš„åæ ‡</p>
                    <p class="indent">â€¢ <strong>é¢œè‰² c âˆˆ â„Â³</strong> â€” è¯¥é«˜æ–¯çš„RGBé¢œè‰²å€¼ï¼ˆé€šè¿‡çƒè°å‡½æ•°è¡¨ç¤ºï¼‰</p>
                    <p class="indent">â€¢ <strong>ä¸é€æ˜åº¦ Î± âˆˆ [0,1]</strong> â€” æ§åˆ¶è¯¥é«˜æ–¯çš„ä¸é€æ˜ç¨‹åº¦</p>
                    <p class="indent">â€¢ <strong>åæ–¹å·® Î£ âˆˆ â„Â³Ë£Â³</strong> â€” å†³å®šé«˜æ–¯çš„3Då½¢çŠ¶ã€å¤§å°å’Œæ–¹å‘</p>
                    <p></p>
                    <p>æ¸²æŸ“æ—¶ï¼Œå°†3Dé«˜æ–¯æŠ•å½±ï¼ˆsplattingï¼‰åˆ°2Då›¾åƒå¹³é¢ï¼Œç„¶åé€šè¿‡ <strong>Alpha Blending</strong> å°†é‡å çš„é«˜æ–¯æ··åˆï¼Œå¾—åˆ°æœ€ç»ˆåƒç´ é¢œè‰²ã€‚</p>
                `
            },
            {
                title: "ğŸ“Š Step 1: æ·±åº¦æ’åº (Depth Sorting)",
                content: `
                    <p>æ¸²æŸ“å‰çš„å…³é”®æ­¥éª¤ï¼šæŒ‰æ·±åº¦å¯¹æ‰€æœ‰é«˜æ–¯è¿›è¡Œæ’åºã€‚</p>
                    <p></p>
                    <p class="highlight">âš ï¸ é‡è¦ï¼š3DGS ä½¿ç”¨ã€å‰å‘ç´¯ç§¯ã€‘(Front-to-Back) ç­–ç•¥ï¼</p>
                    <p></p>
                    <p><strong>æ’åºè§„åˆ™ï¼š</strong>æŒ‰é«˜æ–¯ä¸­å¿ƒåˆ°ç›¸æœºçš„è·ç¦»ï¼Œä»ã€è¿‘åˆ°è¿œã€‘æ’åº</p>
                    <p></p>
                    <p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ˆæŒ‰å¤„ç†é¡ºåºï¼‰ï¼š</p>
                    <p class="indent">1ï¸âƒ£ Gâ‚ (è“è‰²) â€” è·ç¦»ç›¸æœºæœ€è¿‘ï¼Œæœ€å…ˆå¤„ç†</p>
                    <p class="indent">2ï¸âƒ£ Gâ‚‚ (ç»¿è‰²) â€” è·ç¦»ä¸­ç­‰ï¼Œç¬¬äºŒä¸ªå¤„ç†</p>
                    <p class="indent">3ï¸âƒ£ Gâ‚ƒ (çº¢è‰²) â€” è·ç¦»ç›¸æœºæœ€è¿œï¼Œæœ€åå¤„ç†</p>
                    <p></p>
                    <p><strong>ä¸ºä»€ä¹ˆç”¨ Front-to-Backï¼Ÿ</strong></p>
                    <p class="indent">â€¢ å¯ä»¥æå‰ç»ˆæ­¢ï¼šå½“ç´¯ç§¯é€å°„ç‡Tæ¥è¿‘0æ—¶ï¼Œåé¢çš„é«˜æ–¯è´¡çŒ®å¯å¿½ç•¥</p>
                    <p class="indent">â€¢ æ›´é€‚åˆGPUå¹¶è¡Œè®¡ç®—å’Œå†…å­˜è®¿é—®æ¨¡å¼</p>
                `
            },
            {
                title: "ğŸ“ Step 2: Alpha Blending æ ¸å¿ƒå…¬å¼",
                content: `
                    <p>3DGS ä½¿ç”¨çš„æ˜¯ Volume Rendering çš„ç¦»æ•£åŒ–å½¢å¼ï¼š</p>
                    <p></p>
                    <p class="formula-line">C = Î£áµ¢ Î±áµ¢ Â· cáµ¢ Â· Táµ¢</p>
                    <p></p>
                    <p>å…¶ä¸­ç´¯ç§¯é€å°„ç‡ Táµ¢ å®šä¹‰ä¸ºï¼š</p>
                    <p class="formula-line">Táµ¢ = âˆâ±¼&lt;áµ¢ (1 - Î±â±¼)</p>
                    <p></p>
                    <p class="highlight">ğŸ’¡ å…³é”®ï¼šTâ‚ = 1ï¼ˆâˆâ±¼&lt;â‚ æ˜¯ç©ºç§¯ï¼Œç©ºç§¯ç­‰äº1ï¼‰</p>
                    <p></p>
                    <p><strong>å±•å¼€å½¢å¼ï¼š</strong></p>
                    <p class="formula-line">C = Î±â‚câ‚ + (1-Î±â‚)Î±â‚‚câ‚‚ + (1-Î±â‚)(1-Î±â‚‚)Î±â‚ƒcâ‚ƒ + ...</p>
                    <p></p>
                    <p><strong>ç¬¦å·è¯´æ˜ï¼š</strong></p>
                    <p class="indent">â€¢ <strong>C</strong> â€” æœ€ç»ˆåƒç´ é¢œè‰²</p>
                    <p class="indent">â€¢ <strong>cáµ¢</strong> â€” ç¬¬ i ä¸ªé«˜æ–¯çš„é¢œè‰²</p>
                    <p class="indent">â€¢ <strong>Î±áµ¢</strong> â€” ç¬¬ i ä¸ªé«˜æ–¯çš„ä¸é€æ˜åº¦</p>
                    <p class="indent">â€¢ <strong>Táµ¢</strong> â€” ç´¯ç§¯é€å°„ç‡ï¼ˆå…‰åˆ°è¾¾ç¬¬iä¸ªé«˜æ–¯å‰å‰©ä½™çš„èƒ½é‡ï¼‰</p>
                `
            },
            {
                title: "ğŸ”µ Step 3: æ··åˆç¬¬ä¸€ä¸ªé«˜æ–¯ Gâ‚ (è“è‰²Â·æœ€è¿‘)",
                content: `
                    <p>ä»ã€æœ€è¿‘ã€‘çš„é«˜æ–¯å¼€å§‹å¤„ç†â€”â€”è¿™æ˜¯ Front-to-Back çš„æ ¸å¿ƒï¼</p>
                    <p></p>
                    <p><strong>Gâ‚ å‚æ•°ï¼š</strong></p>
                    <p class="indent">â€¢ é¢œè‰² câ‚ = (66, 133, 244)  [è“è‰²]</p>
                    <p class="indent">â€¢ ä¸é€æ˜åº¦ Î±â‚ = 0.6</p>
                    <p></p>
                    <p><strong>è®¡ç®—è¿‡ç¨‹ï¼š</strong></p>
                    <p class="formula-line">Tâ‚ = âˆâ±¼&lt;â‚(1-Î±â±¼) = 1  ï¼ˆç©ºç§¯ = 1ï¼Œç¬¬ä¸€ä¸ªé«˜æ–¯å‰æ— é®æŒ¡ï¼‰</p>
                    <p></p>
                    <p class="formula-line">è´¡çŒ®â‚ = Î±â‚ Â· câ‚ Â· Tâ‚ = Î±â‚ Â· câ‚ Â· 1 = Î±â‚câ‚</p>
                    <p class="formula-line">      = 0.6 Ã— (66, 133, 244)</p>
                    <p class="formula-line">      = (39.6, 79.8, 146.4)</p>
                    <p></p>
                    <p class="formula-line">ç´¯ç§¯é¢œè‰² C = (39.6, 79.8, 146.4)</p>
                    <p></p>
                    <p class="highlight">ğŸ’¡ æ³¨æ„ï¼šTâ‚=1ï¼Œæ‰€ä»¥ç¬¬ä¸€é¡¹ç›´æ¥æ˜¯ Î±â‚câ‚ï¼Œä¸éœ€è¦ä¹˜ä»»ä½•é€å°„ç‡ç³»æ•°ï¼</p>
                `
            },
            {
                title: "ğŸŸ¢ Step 4: æ··åˆç¬¬äºŒä¸ªé«˜æ–¯ Gâ‚‚ (ç»¿è‰²Â·ä¸­é—´)",
                content: `
                    <p>ç»§ç»­å¤„ç†ç¬¬äºŒè¿‘çš„é«˜æ–¯ã€‚</p>
                    <p></p>
                    <p><strong>Gâ‚‚ å‚æ•°ï¼š</strong></p>
                    <p class="indent">â€¢ é¢œè‰² câ‚‚ = (76, 175, 80)  [ç»¿è‰²]</p>
                    <p class="indent">â€¢ ä¸é€æ˜åº¦ Î±â‚‚ = 0.5</p>
                    <p></p>
                    <p><strong>è®¡ç®—è¿‡ç¨‹ï¼š</strong></p>
                    <p class="formula-line">Tâ‚‚ = âˆâ±¼&lt;â‚‚(1-Î±â±¼) = (1 - Î±â‚) = (1 - 0.6) = 0.4</p>
                    <p class="indent">ï¼ˆ40% çš„å…‰èƒ½ç©¿è¿‡ Gâ‚ åˆ°è¾¾ Gâ‚‚ï¼‰</p>
                    <p></p>
                    <p class="formula-line">è´¡çŒ®â‚‚ = Î±â‚‚ Â· câ‚‚ Â· Tâ‚‚ = (1-Î±â‚) Â· Î±â‚‚ Â· câ‚‚</p>
                    <p class="formula-line">      = 0.4 Ã— 0.5 Ã— (76, 175, 80)</p>
                    <p class="formula-line">      = (15.2, 35.0, 16.0)</p>
                    <p></p>
                    <p class="formula-line">ç´¯ç§¯é¢œè‰² C = (39.6 + 15.2, 79.8 + 35.0, 146.4 + 16.0)</p>
                    <p class="formula-line">          = (54.8, 114.8, 162.4)</p>
                    <p></p>
                    <p class="highlight">ğŸ’¡ å±•å¼€å…¬å¼ä¸­ï¼Œè¿™ä¸€é¡¹æ˜¯ (1-Î±â‚)Î±â‚‚câ‚‚</p>
                `
            },
            {
                title: "ğŸ”´ Step 5: æ··åˆç¬¬ä¸‰ä¸ªé«˜æ–¯ Gâ‚ƒ (çº¢è‰²Â·æœ€è¿œ)",
                content: `
                    <p>å¤„ç†æœ€è¿œçš„é«˜æ–¯â€”â€”å®ƒå—åˆ°å‰é¢ä¸¤ä¸ªé«˜æ–¯çš„é®æŒ¡æœ€å¤šã€‚</p>
                    <p></p>
                    <p><strong>Gâ‚ƒ å‚æ•°ï¼š</strong></p>
                    <p class="indent">â€¢ é¢œè‰² câ‚ƒ = (230, 76, 76)  [çº¢è‰²]</p>
                    <p class="indent">â€¢ ä¸é€æ˜åº¦ Î±â‚ƒ = 0.7</p>
                    <p></p>
                    <p><strong>è®¡ç®—è¿‡ç¨‹ï¼š</strong></p>
                    <p class="formula-line">Tâ‚ƒ = âˆâ±¼&lt;â‚ƒ(1-Î±â±¼) = (1-Î±â‚)(1-Î±â‚‚) = 0.4 Ã— 0.5 = 0.2</p>
                    <p class="indent">ï¼ˆåªæœ‰ 20% çš„å…‰èƒ½ç©¿è¿‡ Gâ‚ å’Œ Gâ‚‚ åˆ°è¾¾ Gâ‚ƒï¼‰</p>
                    <p></p>
                    <p class="formula-line">è´¡çŒ®â‚ƒ = Î±â‚ƒ Â· câ‚ƒ Â· Tâ‚ƒ = (1-Î±â‚)(1-Î±â‚‚) Â· Î±â‚ƒ Â· câ‚ƒ</p>
                    <p class="formula-line">      = 0.2 Ã— 0.7 Ã— (230, 76, 76)</p>
                    <p class="formula-line">      = (32.2, 10.64, 10.64)</p>
                    <p></p>
                    <p class="formula-line">æœ€ç»ˆé¢œè‰² C = (54.8 + 32.2, 114.8 + 10.64, 162.4 + 10.64)</p>
                    <p class="formula-line">          = (87.0, 125.44, 173.04)</p>
                    <p></p>
                    <p class="highlight">ğŸ’¡ å±•å¼€å…¬å¼ä¸­ï¼Œè¿™ä¸€é¡¹æ˜¯ (1-Î±â‚)(1-Î±â‚‚)Î±â‚ƒcâ‚ƒ</p>
                `
            },
            {
                title: "ğŸ“ æ€»ç»“ï¼šFront-to-Back Alpha Blending",
                content: `
                    <p><strong>3DGS çš„ Alpha Blending å®Œæ•´å…¬å¼ï¼š</strong></p>
                    <p></p>
                    <p class="formula-line">C = Î£áµ¢ Î±áµ¢ Â· cáµ¢ Â· Táµ¢ï¼Œå…¶ä¸­ Táµ¢ = âˆâ±¼&lt;áµ¢(1 - Î±â±¼)ï¼ŒTâ‚ = 1</p>
                    <p></p>
                    <p class="formula-line">å±•å¼€ï¼šC = Î±â‚câ‚ + (1-Î±â‚)Î±â‚‚câ‚‚ + (1-Î±â‚)(1-Î±â‚‚)Î±â‚ƒcâ‚ƒ + ...</p>
                    <p></p>
                    <p><strong>æœ¬ä¾‹è®¡ç®—ç»“æœï¼š</strong></p>
                    <p class="indent">â€¢ Gâ‚ è´¡çŒ®ï¼šÎ±â‚câ‚ = 0.6Ã—(66,133,244) = <strong>(39.6, 79.8, 146.4)</strong></p>
                    <p class="indent">â€¢ Gâ‚‚ è´¡çŒ®ï¼š(1-Î±â‚)Î±â‚‚câ‚‚ = 0.4Ã—0.5Ã—(76,175,80) = <strong>(15.2, 35.0, 16.0)</strong></p>
                    <p class="indent">â€¢ Gâ‚ƒ è´¡çŒ®ï¼š(1-Î±â‚)(1-Î±â‚‚)Î±â‚ƒcâ‚ƒ = 0.2Ã—0.7Ã—(230,76,76) = <strong>(32.2, 10.64, 10.64)</strong></p>
                    <p></p>
                    <p class="formula-line">æœ€ç»ˆ C = (87.0, 125.44, 173.04)</p>
                    <p></p>
                    <p><strong>å…³é”®è¦ç‚¹ï¼š</strong></p>
                    <p class="highlight">âœ… Tâ‚ = 1ï¼ˆç©ºç§¯ç­‰äº1ï¼Œç¬¬ä¸€ä¸ªé«˜æ–¯ç›´æ¥ä¹˜ Î±â‚câ‚ï¼‰</p>
                    <p class="highlight">âœ… è¶Šè¿œçš„é«˜æ–¯ï¼ŒTáµ¢ è¶Šå°ï¼Œè´¡çŒ®è¶Šè¢«è¡°å‡</p>
                    <p class="highlight">âœ… æœ€è¿‘çš„é«˜æ–¯å¯¹æœ€ç»ˆé¢œè‰²å½±å“æœ€å¤§</p>
                    <p class="highlight">âœ… å¯æå‰ç»ˆæ­¢ï¼šå½“ Táµ¢ â‰ˆ 0 æ—¶ï¼Œåç»­é«˜æ–¯è´¡çŒ®å¯å¿½ç•¥</p>
                `
            }
        ];
        
        // çŠ¶æ€
        let currentStep = 0;
        let isPlaying = false;
        let playInterval = null;
        const totalSteps = subtitles.length;
        
        // åˆå§‹åŒ–
        function init() {
            document.getElementById('totalSteps').textContent = totalSteps;
            createStepIndicators();
            updateDisplay();
        }
        
        // åˆ›å»ºæ­¥éª¤æŒ‡ç¤ºå™¨
        function createStepIndicators() {
            const container = document.getElementById('stepIndicators');
            container.innerHTML = '';
            for (let i = 0; i < totalSteps; i++) {
                const dot = document.createElement('div');
                dot.className = 'step-dot';
                dot.onclick = () => goToStep(i);
                container.appendChild(dot);
            }
        }
        
        // è®¡ç®—æ··åˆé¢œè‰²ï¼ˆä¸å«èƒŒæ™¯è‰²ï¼‰
        // C = Î£áµ¢ Î±áµ¢ Â· cáµ¢ Â· Táµ¢ï¼Œå…¶ä¸­ Tâ‚ = 1
        function calculateBlending(activeCount) {
            let color = [0, 0, 0];
            let T = 1;  // Tâ‚ = 1ï¼ˆç©ºç§¯ï¼‰
            
            for (let i = 0; i < Math.min(activeCount, gaussians.length); i++) {
                const g = gaussians[i];
                // è´¡çŒ® = Î±áµ¢ Ã— cáµ¢ Ã— Táµ¢
                const contribution = g.color.map(c => g.alpha * c * T);
                color = color.map((c, idx) => c + contribution[idx]);
                
                // æ›´æ–°Tä¸ºä¸‹ä¸€ä¸ªé«˜æ–¯çš„é€å°„ç‡
                T *= (1 - g.alpha);
            }
            
            return { color, T };
        }
        
        // è·å–æ´»è·ƒçš„é«˜æ–¯æ•°é‡
        function getActiveCount() {
            if (currentStep < 3) return 0;
            if (currentStep === 3) return 1;
            if (currentStep === 4) return 2;
            if (currentStep >= 5) return 3;
            return 0;
        }
        
        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            const activeCount = getActiveCount();
            const result = calculateBlending(activeCount);
            
            // æ›´æ–°å­—å¹•
            document.getElementById('expTitle').textContent = subtitles[currentStep].title;
            document.getElementById('expText').innerHTML = subtitles[currentStep].content;
            
            // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
            const dots = document.querySelectorAll('.step-dot');
            dots.forEach((dot, i) => {
                dot.className = 'step-dot';
                if (i === currentStep) dot.classList.add('active');
                else if (i < currentStep) dot.classList.add('passed');
            });
            
            // æ›´æ–°é«˜æ–¯çŠ¶æ€
            const g1 = document.getElementById('g1');
            const g2 = document.getElementById('g2');
            const g3 = document.getElementById('g3');
            
            g1.className = 'gaussian gaussian-1';
            g2.className = 'gaussian gaussian-2';
            g3.className = 'gaussian gaussian-3';
            
            if (activeCount >= 1) g1.classList.add('active');
            if (activeCount >= 2) g2.classList.add('active');
            if (activeCount >= 3) g3.classList.add('active');
            
            if (currentStep === 3) g1.classList.add('current');
            if (currentStep === 4) g2.classList.add('current');
            if (currentStep === 5) g3.classList.add('current');
            
            // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
            document.getElementById('status1').className = 'status-item g1' + (activeCount >= 1 ? ' active' : '');
            document.getElementById('status2').className = 'status-item g2' + (activeCount >= 2 ? ' active' : '');
            document.getElementById('status3').className = 'status-item g3' + (activeCount >= 3 ? ' active' : '');
            
            document.getElementById('status1').textContent = activeCount >= 1 ? 'Gâ‚ âœ“' : 'Gâ‚';
            document.getElementById('status2').textContent = activeCount >= 2 ? 'Gâ‚‚ âœ“' : 'Gâ‚‚';
            document.getElementById('status3').textContent = activeCount >= 3 ? 'Gâ‚ƒ âœ“' : 'Gâ‚ƒ';
            
            // æ›´æ–°é¢œè‰²é¢„è§ˆ
            const preview = document.getElementById('colorPreview');
            if (activeCount > 0) {
                preview.style.background = `rgb(${Math.round(result.color[0])}, ${Math.round(result.color[1])}, ${Math.round(result.color[2])})`;
                preview.style.boxShadow = `0 6px 20px rgba(${Math.round(result.color[0])}, ${Math.round(result.color[1])}, ${Math.round(result.color[2])}, 0.5)`;
            } else {
                preview.style.background = '#000';
                preview.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
            }
            
            // æ›´æ–°RGBå€¼å’Œé€å°„ç‡
            const infoGrid = document.getElementById('infoGrid');
            if (currentStep >= 3) {
                infoGrid.style.display = 'grid';
                document.getElementById('rgbR').textContent = Math.round(result.color[0] * 10) / 10;
                document.getElementById('rgbG').textContent = Math.round(result.color[1] * 10) / 10;
                document.getElementById('rgbB').textContent = Math.round(result.color[2] * 10) / 10;
                
                // æ˜¾ç¤ºå„ä¸ªTå€¼
                let tText = 'Tâ‚=1';
                if (activeCount >= 2) tText += ', Tâ‚‚=0.4';
                if (activeCount >= 3) tText += ', Tâ‚ƒ=0.2';
                document.getElementById('transmittance').textContent = tText;
            } else {
                infoGrid.style.display = 'none';
            }
            
            // æ›´æ–°å…¬å¼å’Œé¡ºåºæŒ‡ç¤ºå™¨
            document.getElementById('formulaBox').className = 'formula-box' + (currentStep >= 2 ? ' visible' : '');
            document.getElementById('orderIndicator').className = 'order-indicator' + (currentStep >= 1 ? ' visible' : '');
            
            // æ›´æ–°è¿›åº¦
            document.getElementById('currentStep').textContent = currentStep + 1;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('prevBtn').disabled = currentStep === 0;
            document.getElementById('nextBtn').disabled = currentStep === totalSteps - 1;
        }
        
        // æ­¥éª¤æ§åˆ¶
        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateDisplay();
            }
        }
        
        function nextStep() {
            if (currentStep < totalSteps - 1) {
                currentStep++;
                updateDisplay();
            }
        }
        
        function goToStep(step) {
            currentStep = step;
            updateDisplay();
        }
        
        function resetDemo() {
            stopPlay();
            currentStep = 0;
            updateDisplay();
        }
        
        // è‡ªåŠ¨æ’­æ”¾
        function togglePlay() {
            if (isPlaying) {
                stopPlay();
            } else {
                startPlay();
            }
        }
        
        function startPlay() {
            isPlaying = true;
            document.getElementById('playBtn').textContent = 'â¸ æš‚åœ';
            document.getElementById('playBtn').classList.add('playing');
            
            playInterval = setInterval(() => {
                if (currentStep < totalSteps - 1) {
                    currentStep++;
                    updateDisplay();
                } else {
                    stopPlay();
                }
            }, 5000);
        }
        
        function stopPlay() {
            isPlaying = false;
            document.getElementById('playBtn').textContent = 'â–¶ è‡ªåŠ¨æ’­æ”¾';
            document.getElementById('playBtn').classList.remove('playing');
            
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
        }
        
        // é”®ç›˜æ§åˆ¶
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') prevStep();
            if (e.key === 'ArrowRight') nextStep();
            if (e.key === ' ') {
                e.preventDefault();
                togglePlay();
            }
        });
        
        // åˆå§‹åŒ–
        init();
    </script>
</body>
</html>
